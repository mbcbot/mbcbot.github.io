<!DOCTYPE html>
<html lang="en" >
    <head>
        <meta name="author" content="Ashik saleem">
        <meta name="keywords" content="mbc, mbccet, mbcpeermade, s6, cse">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
        <title>Mbcbot Comparator</title>
        <link rel="stylesheet" href="css/scale_2.0.css">
    </head>
    <body>

        <div id="screen"></div>
        <div class="container">
            <div id="caption">Compare Attendence</div>
            <div class="row">
              <img id="player1"/>
              <div class="vs">VS</div>
              <div id="spinr"></div>
              <img onload="halt()" id="referee"/>
              <input list="mates" id="player2" placeholder="Choose ..." oninput="validate()">
              <datalist id="mates">
                <option name="5048" value="Abin oommen">
                <option name="5049" value="Afraim Joseph">
                <option name="5050" value="Aibin Thomas Mathew">
                <option name="5047" value="Ajith M James">
                <option name="5051" value="Akash C Babu">
                <option name="5052" value="Amal Santhosh">
                <option name="5053" value="Amina ubaid">
                <option name="5055" value="Ansu Sara Shajan">
                <option name="4983" value="Ashik saleem">
                <option name="5174" value="Astin kurien siby">
                <option name="5056" value="Athul Baby">
                <option name="5058" value="Don Joseph">
                <option name="5059" value="Ebinu suneer">
                <option name="4968" value="Emil Jacob John">
                <option name="5060" value="Jeffery Thomas Paul">
                <option name="5175" value="Jisha Varghese">
                <option name="5061" value="Jithin T Jacob">
                <option name="5062" value="Jitin Joby">
                <option name="5063" value="Joel Jacob">
                <option name="5064" value="Joel Mathews">
                <option name="5178" value="Kripa Mariam Sunny">
                <option name="5173" value="Leon James">
                <option name="5176" value="Loriene Brighty Kishore">
                <option name="4972" value="Prince Babu">
                <option name="5066" value="Richy Thampi">
                <option name="4960" value="Riya K Vinod">
                <option name="5067" value="Rohan Moses">
                <option name="5068" value="Rony Zacharia George">
                <option name="5065" value="Rosemary Scaria">
                <option name="5069" value="Sandra Ann Sunny">
                <option name="4995" value="Shalu Merin John">
                <option name="5070" value="Sharon P Raju">
                <option name="5073" value="Shijin George Stephen">
                <option name="5074" value="Shijin Joseph">
                <option name="5075" value="Sijo John Thomas">
                <option name="5076" value="Sneha Mariam Chacko">
                <option name="5077" value="Solamon J Purackan">
                <option name="5078" value="Soumya M S">
                <option name="4969" value="Tibin Sunny">
                <option name="5278" value="Ajith Rajan">
              </datalist>

            </div>
            <div id="desc">
              <table>
                <tbody id="total"></tbody>
              </table>
            </div>
            <div id="more">
              <table>
                <tbody id="marks"></tbody>
              </table>
            </div>
            <button id="finish" onclick="fight(0)">Next</button>
            <button id="skip" onclick="skip(0)">Back</button>
        </div>
        <script>
          var ad;
          var t1=0;
          var t2=0;
          var subs = ["DAA","CD","CN","SEPM","POM","WT","CE"];
          var Opponent;
          var payload;

          if(window.location.href.split("chain=")[1] == "" || window.location.href.split("chain=")[1] == undefined){
            err(1);
          }else{
            var chain=window.location.href.split("chain=")[1];
            var s1=chain.split("nba")[0]; // Part : a/b
            var s2=chain.split("nba")[1]; // Admsn No. : 4983
            var s3=chain.split("nba")[2]; // Total : 99.9
            var s4=chain.split("nba")[3]; // Chain : 100x100x...x

            if(s1 == "" || s1 == undefined || s2 == "" || s2 == undefined || s3 == "" || s3 == undefined  || s4 == "" || s4 == undefined ){
              err(2);
            }else{
              if(s1 == "a"){
                // Part A
                // UFC.html?chain=anba4983nba99.9nba82.35x90.48x87.5x90x93.33x94.12x100x

                localStorage.setItem("ufcAd",s2);
                localStorage.setItem("ufcTotal",s3);
                localStorage.setItem("ufcData",s4);

                document.getElementById("player1").src="https://images.weserv.nl/?url=http://mbccet.com/img_small/"+s2+".jpg";
                document.getElementById("screen").style.display="none";

              }else if(s1 == "b"){
                // Part B
                // UFC.html?chain=bnba5174nba90.1nba58.82x90.48x87.5x95x80x88.24x66.67x

                if(localStorage.getItem("ufcAd") == null || localStorage.getItem("ufcTotal") == null || localStorage.getItem("ufcData") == null){
                  err(3);
                }else{

                  t1 = localStorage.getItem("ufcTotal");
                  t2 = s3;
                  ad=localStorage.getItem("ufcAd");

                  document.getElementById("player1").src="https://images.weserv.nl/?url=http://mbccet.com/img_small/"+ad+".jpg";
                  document.getElementById("referee").src="https://images.weserv.nl/?url=http://mbccet.com/img_small/"+s2+".jpg";

                  document.getElementById("player2").style.display="none";
                  document.getElementById("spinr").style.display="block";
                  document.getElementById("desc").style.display="block";
                  document.getElementById("more").style.display="block";
                  document.getElementById("finish").style.display="none";
                  document.getElementById("skip").setAttribute("onclick","skip(2)");
                  document.getElementById("screen").style.display="none";

                  payload=localStorage.getItem("ufcData");

                  var c1=payload.split("x");
                  var c2=s4.split("x");

                  var txt1;
                  var txt2;
                  for(var i=0;i<7;i++){

                    if(c1[i] > 89){txt1="<td>"+c1[i]+"</td>";}
                    else if(c1[i] > 76){txt1="<td>"+c1[i]+"</td>";}
                    else{txt1="<td class='red'>"+c1[i]+"</td>";}

                    if(c2[i] > 89){txt2="<td>"+c2[i]+"</td>";}
                    else if(c2[i] > 76){txt2="<td>"+c2[i]+"</td>";}
                    else{txt2="<td class='red'>"+c2[i]+"</td>";}

                    document.getElementById("marks").innerHTML+="<tr>"+txt1+"<td>"+subs[i]+"</td>"+txt2+"</tr>";
                  }

                  document.getElementById("total").innerHTML+="<tr><td>"+t1+"%</td><td>"+t2+"%</td></tr><tr><td></td><td></td></tr>";

                  if(t1  == t2){
                    document.getElementById("caption").innerHTML="Equal Attendence";
                  }else if(t1 > t2){
                    document.getElementById("player1").style.transform="scale(1.1)";
                    document.getElementById("player1").style.animation="1s win 1";
                    document.getElementById("referee").style.transform="scale(0.8)";
                    document.getElementById("referee").style.animation="1s nxt 1";
                    document.getElementById("caption").innerHTML="Leading by "+Math.round(t1-t2)+"%<span class='green'>▲</span>";

                  }else{
                    document.getElementById("player1").style.transform="scale(0.8)";
                    document.getElementById("player1").style.animation="1s nxt 1";
                    document.getElementById("referee").style.transform="scale(1.1)";
                    document.getElementById("referee").style.animation="1s win 1";
                    document.getElementById("caption").innerHTML="Behind by "+Math.round(t2-t1)+"%<span class='red'>▼</span>";

                  }
                }

              }else{
                err(4);
              }
            }
          }

          function halt(){
            document.getElementById("spinr").style.display="none";
            document.getElementById("skip").style.display="block";
            document.getElementById("referee").style.display="block";
          }

          function validate(){
            var datalist = document.getElementById('player2');
            var mates = document.getElementsByTagName("option");


            document.getElementById("finish").style.background ="#f8f8f8";
            document.getElementById("finish").style.color ="#898989";
            document.getElementById("finish").style.pointerEvents ="none";

            for(var i = 0; i < mates.length; i++){
                if(mates[i].getAttribute("value") === datalist.value){

                  document.getElementById("finish").style.background ="#6c7ae0";
                  document.getElementById("finish").style.color ="#fff";
                  document.getElementById("finish").style.pointerEvents ="all";
                  Opponent=mates[i].getAttribute("name");
                  break;
                }
            }
          }


          function skip(x){
            if(x == 0){
              document.title="Loading..";
              window.location.replace("https://mbcbot.github.io");
              document.getElementById("skip").textContent="loading"
            }else if(x == 1){
              document.getElementById("referee").style.display="none";
              document.getElementById("player2").style.display="block";
              document.getElementById("finish").textContent="Next";
              document.getElementById("finish").setAttribute("onclick","fight(0)");
              document.getElementById("skip").textContent="Back";
              document.getElementById("skip").setAttribute("onclick","skip(0)");
            }else{
              window.location.replace("https://mbcbot.github.io/UFC.html?chain=anba"+ad+"nba"+t1+"nba"+payload);

            }
          }


          function fight(y){
            if(y  == 0){
              document.getElementById("player2").style.display="none";
              document.getElementById("referee").src="https://images.weserv.nl/?url=http://mbccet.com/img_small/"+Opponent+".jpg";
              document.getElementById("spinr").style.display="block";
              document.getElementById("finish").textContent="Done";
              document.getElementById("finish").setAttribute("onclick","fight(1)");
              document.getElementById("skip").textContent="Cancel";
              document.getElementById("skip").setAttribute("onclick","skip(1)");
              document.getElementById("skip").style.display="none";
            }else{
              document.getElementById("skip").style.display="none";
              document.getElementById("caption").textContent="Comparing..";
              document.getElementById("finish").textContent="loading";
              document.getElementById("finish").style.pointerEvents ="none";
              window.location.replace("https://script.google.com/a/macros/mbcpeermade.com/s/AKfycbxYGNPLnrjOTXPcFNIk7xXWP4313oWzrKvJQyaw1mLaNbEf9mk/exec?pwd="+new Date().getDay()+"&wwe=y&foe="+Opponent);
            }
          }

        function err(z){
          document.title="Loading..";
          window.location.replace("https://mbcbot.github.io?ufc=err"+z);
        }

        </script> 
    </body>
</html>
